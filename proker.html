<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dokumentasi Proker - Pradupta</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #f8fafc;
            margin: 0;
            padding: 0;
            color: #1e293b;
        }

        .header-gradient {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            border-radius: 0 0 35px 35px;
            box-shadow: 0 10px 25px -5px rgba(220, 38, 38, 0.3);
        }

        .card-proker {
            background: white;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border: 1px solid #f1f5f9;
        }

        .card-proker:active { transform: scale(0.95); }

        .text-shadow-lg { text-shadow: 0 2px 8px rgba(0,0,0,0.7); }

        .loading-shimmer {
            background: linear-gradient(90deg, #f1f5f9 25%, #e2e8f0 50%, #f1f5f9 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .animate-fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="min-h-screen pb-10">

    <header class="header-gradient p-6 mb-6 sticky top-0 z-50">
        <div class="max-w-md mx-auto flex justify-between items-center pt-2">
            <div class="flex items-center gap-4">
                <a href="app.html" class="w-10 h-10 bg-white/10 backdrop-blur-lg rounded-2xl flex items-center justify-center text-white border border-white/20 active:scale-90 transition-all">
                    <i class="fas fa-chevron-left"></i>
                </a>
                <div>
                    <p class="text-[10px] text-white/70 font-bold uppercase tracking-[0.2em]">Dokumentasi</p>
                    <h2 class="text-xl font-black text-white tracking-tight">PROKER KAMI</h2>
                </div>
            </div>
            
            <div id="back-to-grid" class="hidden">
                <button onclick="loadProkerGrid()" class="bg-white text-red-600 text-[10px] px-4 py-2.5 rounded-2xl font-extrabold shadow-lg active:scale-90 transition-all flex items-center gap-2">
                    <i class="fas fa-th-large"></i> SEMUA
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-md mx-auto px-5">
        <div id="proker-content">
            <div class="flex flex-col items-center justify-center py-32">
                <div class="w-12 h-12 border-4 border-red-100 border-t-red-600 rounded-full animate-spin mb-4"></div>
                <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Sinkronisasi Drive...</p>
            </div>
        </div>
    </main>

    <footer class="mt-12 text-center opacity-30">
        <img src="https://pradupta.github.io/web/img/logo.png" class="w-8 mx-auto grayscale mb-2">
        <p class="text-[9px] font-bold uppercase tracking-widest">ScoutDupta App</p>
    </footer>

    <script>
        // Pastikan URL ini adalah URL terbaru dari Deployment "Anyone" di Apps Script
        const PROKER_API_URL = "https://script.google.com/macros/s/AKfycbzqY8fhhuvJECItQVcON98i8MjnQC33zytWAkBIYeGAmxgmMwo8O_0Uro49Qgvqmd32/exec";

        async function loadProkerGrid() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            $('#back-to-grid').addClass('hidden');
            const container = $('#proker-content');
            
            container.html('<div class="grid grid-cols-2 gap-4">' + 
                Array(4).fill('<div class="aspect-[4/5] rounded-[2.5rem] loading-shimmer"></div>').join('') + 
                '</div>');

            try {
                const response = await fetch(PROKER_API_URL);
                const folders = await response.json();
                
                let html = '<div class="grid grid-cols-2 gap-4 animate-fade-in">';
                folders.forEach(f => {
                    html += `
                        <div onclick="openProkerFolder('${f.id}', '${f.name}')" class="card-proker relative aspect-[4/5] rounded-[2rem] overflow-hidden group border-none">
                            <img src="${f.cover}" referrerpolicy="no-referrer" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" loading="lazy">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent flex flex-col justify-end p-5">
                                <span class="text-white text-[11px] font-black uppercase leading-tight tracking-wide text-shadow-lg">${f.name}</span>
                            </div>
                        </div>`;
                });
                html += '</div>';
                container.html(html);
            } catch (err) {
                container.html('<div class="text-center py-20 text-red-500 font-bold text-xs uppercase">Gagal memuat Drive. Cek Izin Folder.</div>');
            }
        }

        async function openProkerFolder(folderId, folderName) {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            $('#back-to-grid').removeClass('hidden');
            const container = $('#proker-content');
            
            container.html(`
                <div class="text-center py-32 animate-fade-in">
                    <div class="w-10 h-10 border-4 border-red-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Membuka Album...</p>
                </div>`);

            try {
                // Mengirim parameter folderId sesuai update Apps Script
                const response = await fetch(`${PROKER_API_URL}?folderId=${folderId}`);
                const photos = await response.json();
                
                let html = `
                    <div class="mb-6 flex items-center gap-3 animate-fade-in">
                        <div class="h-6 w-1.5 bg-red-600 rounded-full"></div>
                        <h3 class="text-sm font-black text-slate-800 uppercase tracking-wider">${folderName}</h3>
                    </div>`;
                
                html += '<div class="grid grid-cols-3 gap-2 animate-fade-in">';
                
                if (photos.length === 0) {
                    html += '<div class="col-span-3 py-20 text-center text-slate-300 text-[10px] font-bold uppercase">Belum ada foto</div>';
                } else {
                    photos.forEach(p => {
                        html += `
                            <div class="aspect-square rounded-2xl overflow-hidden bg-slate-100 shadow-sm active:scale-90 transition-all duration-300">
                                <img src="${p.url}" referrerpolicy="no-referrer" class="w-full h-full object-cover" loading="lazy" 
                                     onclick="window.open('${p.url.replace('=s1000', '=s0')}', '_blank')">
                            </div>`;
                    });
                }
                
                html += '</div>';
                container.html(html);
            } catch (err) {
                container.html('<p class="text-center py-20 text-red-500 font-bold text-[10px] uppercase">Gagal memuat foto</p>');
            }
        }

        $(document).ready(function() {
            loadProkerGrid();
        });
    </script>
</body>
</html>
